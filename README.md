# 🏪 편의점 결제 시스템
구매자의 **할인 혜택**과 **재고 상황**을 고려하여 최종 결제 금액을 계산하고 안내하는 콘솔 기반 결제 프로그램입니다.

--- 

## 🛠️ 기술 스택
| 구분           | 사용 기술 |
|--------------|------------|
| **Language** | ![Java](https://img.shields.io/badge/Java-21-007396?logo=openjdk&logoColor=white) |
| **Testing**  | ![JUnit5](https://img.shields.io/badge/JUnit5-25A162?logo=junit5&logoColor=white) ![AssertJ](https://img.shields.io/badge/AssertJ-5A5A5A?logo=java&logoColor=white)|
| **Tools**    | ![IntelliJ IDEA](https://img.shields.io/badge/IntelliJ%20IDEA-000000?logo=intellijidea&logoColor=white) |
| **Docs**     | ![Markdown](https://img.shields.io/badge/Markdown-000000?logo=markdown&logoColor=white)|
   

---

## 📂 패키지 구조
```
store
 ├─ app
 │   ├─ Application              # 프로그램 실행 진입점
 │   ├─ OrderFactory             # 주문 생성
 │   ├─ ProductManagerFactory    # 상품 관리 객체 생성
 │   └─ StoreManager             # 전체 프로그램 실행 흐름 관리
 │
 ├─ domain
 │   ├─ Order                    # 주문 엔티티
 │   ├─ OrderItem                # 주문 상품 엔티티
 │   ├─ Product                  # 상품 엔티티
 │   └─ Promotion                # 프로모션 엔티티
 │
 ├─ dto
 │   ├─ OrderItemRequest         # 주문 항목 요청 DTO
 │   └─ OrderItemResponse        # 주문 항목 응답 DTO
 │
 ├─ exception
 │   └─ ErrorCode                # 에러 코드 정의
 │
 ├─ service
 │   ├─ ProductManager           # 상품 관리 서비스
 │   └─ PromotionManager         # 프로모션 관리 서비스
 │
 ├─ util
 │   ├─ StoreFileReader          # 파일 읽기 유틸
 │   ├─ StoreFormatter           # 데이터 포맷 변환 유틸
 │   ├─ StoreMapper              # 매핑 유틸
 │   └─ StoreParser              # 파싱 유틸
 │
 └─ view
     ├─ InputView                # 사용자 입력 처리
     └─ OutputView               # 출력 처리
```

--- 

## 🧭 플로우 차트
상품 재고 업데이트 및 프로모션 적용 흐름

<img width="1413" height="505" alt="편의점_플로우차트" src="https://github.com/user-attachments/assets/98def4b8-71d9-4876-84f2-1d48a64e00a9" />

---

## 🧩 주요 기능

### 🛒 상품
- 상품 이름, 가격, 재고 수량, 프로모션 정보를 관리
- 유효하지 않은 상품 정보 입력 시 `INVALID_PRODUCT` 예외 발생
- 프로모션 여부, 재고 비교, 조건 충족 여부 판단
- 구매 수량 차감 및 무료 증정 계산 기능 제공

### 📦 상품 재고 관리
- 판매 상품 등록 및 조회
- 프로모션 기간 만료 시 해당 상품 자동 제거
- 존재하지 않는 상품 조회 시 `PRODUCT_NOT_FOUND` 예외 발생

### 🎁 프로모션
- 프로모션 이름, 조건(구매 N개 + 무료 M개), 기간 정보 관리
- 프로모션명으로 조회
- 조건 검증 및 혜택 계산
- 기간 만료 또는 비활성 프로모션 예외 처리
- 유효하지 않은 프로모션 상품 조회 시 `PROMOTION_NOT_FOUND` 예외 발생

### 💳 주문 및 결제
- 주문 상품 리스트, 총 구매액, 할인 금액, 최종 결제 금액 관리
- 프로모션 할인 및 멤버십 할인 계산

### 💸 프로모션 할인
- 기간 내 `N+1` 혜택 제공 및 중복 적용 방지
- 프로모션 재고 우선 차감
- 재고 부족 시 일부 수량 일반 상품으로 전환

### 🪪 멤버십 할인
- 프로모션 미적용 상품의 총액 30% 할인
- 최대 8,000원 한도 적용

### 🖥️ 입출력
- 사용자 입력(주문, 멤버십 여부, 정가 구매 여부, 추가 구매 여부) 처리
- 잘못된 입력 시 `[ERROR]` 메시지 출력 후 재입력 유도
- 상품 목록, 영수증, 안내 문구 출력

---

## 실행 결과 예시
```

안녕하세요. W편의점입니다.
현재 보유하고 있는 상품입니다.

- 콜라 1,000원 10개 탄산2+1
- 콜라 1,000원 10개 
- 사이다 1,000원 8개 탄산2+1
- 사이다 1,000원 7개 
- 오렌지주스 1,800원 9개 MD추천상품
- 오렌지주스 1,800원 재고 없음 
- 탄산수 1,200원 5개 탄산2+1
- 탄산수 1,200원 재고 없음 
- 물 500원 10개 
- 비타민워터 1,500원 6개 
- 감자칩 1,500원 5개 반짝할인
- 감자칩 1,500원 5개 
- 초코바 1,200원 5개 MD추천상품
- 초코바 1,200원 5개 
- 에너지바 2,000원 5개 
- 정식도시락 6,400원 8개 
- 컵라면 1,700원 1개 MD추천상품
- 컵라면 1,700원 10개 

구매하실 상품명과 수량을 입력해 주세요. (예: [사이다-2],[감자칩-1])
[콜라-3],[에너지바-5]

멤버십 할인을 받으시겠습니까? (Y/N)
Y

==============W 편의점================
상품명	수량	금액
콜라	3	3,000
에너지바	5	10,000
=============증	정===============
콜라	1
====================================
총구매액	8	13,000
행사할인		-1,000
멤버십할인		-3,000
내실돈		9,000

감사합니다. 구매하고 싶은 다른 상품이 있나요? (Y/N)
y

안녕하세요. W편의점입니다.
현재 보유하고 있는 상품입니다.

- 콜라 1,000원 7개 탄산2+1
- 콜라 1,000원 10개 
- 사이다 1,000원 8개 탄산2+1
- 사이다 1,000원 7개 
- 오렌지주스 1,800원 9개 MD추천상품
- 오렌지주스 1,800원 재고 없음 
- 탄산수 1,200원 5개 탄산2+1
- 탄산수 1,200원 재고 없음 
- 물 500원 10개 
- 비타민워터 1,500원 6개 
- 감자칩 1,500원 5개 반짝할인
- 감자칩 1,500원 5개 
- 초코바 1,200원 5개 MD추천상품
- 초코바 1,200원 5개 
- 에너지바 2,000원 재고 없음 
- 정식도시락 6,400원 8개 
- 컵라면 1,700원 1개 MD추천상품
- 컵라면 1,700원 10개 

구매하실 상품명과 수량을 입력해 주세요. (예: [사이다-2],[감자칩-1])
[콜라-10]

현재 콜라 4개는 프로모션 할인이 적용되지 않습니다. 그래도 구매하시겠습니까? (Y/N)
y

멤버십 할인을 받으시겠습니까? (Y/N)
N

==============W 편의점================
상품명	수량	금액
콜라	10	10,000
=============증	정===============
콜라	2
====================================
총구매액	10	10,000
행사할인		-2,000
멤버십할인		-0
내실돈		8,000

감사합니다. 구매하고 싶은 다른 상품이 있나요? (Y/N)
n

```

---

## ⚙️ 예외 처리

| 구분 | 예외 상황 | 메시지 예시 |
|------|------------|-------------|
| 입력 형식 오류 | `[사이다-2]` 형식이 아닌 경우 | `[ERROR] 올바르지 않은 형식으로 입력했습니다. 다시 입력해 주세요.` |
| 존재하지 않는 상품 | 잘못된 상품명 입력 | `[ERROR] 존재하지 않는 상품입니다.` |
| 재고 초과 | 구매 수량 > 재고 수량 | `[ERROR] 재고 수량을 초과하여 구매할 수 없습니다.` |
| 기타 | Y/N 외 입력 | `[ERROR] 잘못된 입력입니다. 다시 입력해 주세요.` |

---

## 🧠 프로젝트 개요

- MVC 구조 기반으로 도메인 로직, 입출력, 서비스 로직을 명확히 분리
- 테스트 주도 개발(TDD)을 적용하여 각 기능의 단위 테스트 검증
- 사용자 친화적인 에러 메시지와 재입력 유도 로직 구현
- 실제 편의점 구매 플로우를 콘솔에서 완전 재현

---

## 📄 참고 자료

- `/src/main/resources/products.md`
- `/src/main/resources/promotions.md`  
  → 파일 리더(`StoreFileReader`)를 통해 상품 및 프로모션 정보 로드
